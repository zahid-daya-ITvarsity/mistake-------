<!DOCTYPE html>
<html>
    <head>
        <title>Countdown Timer</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale =1.0">
        <link rel="stylesheet" href="style.css"/>
    </head>
    <body>
        <div class="container">

            <svg id="progressBarContainer" width="144" height="300">

                <pattern id="pattern1" x="0" y="0" width="12" height="12" patternUnits="userSpaceOnUse">
                    <circle x="5" y="5" r="3" stroke="0" fill="white"></circle>
                </pattern>

                <rect id="progressBar" x="0" y="0" width="144" height="300" style="fill:url(#pattern1);"></rect>

            </svg>
            <div id="clock">
                <p>Ready!</p>
            </div>
            <div id="content">
                <select class="selector" id="hours">
                    <option value="0">0 Hours</option>
                    <option value="1">1 Hours</option>
                    <option value="2">2 Hours</option>
                    <option value="3">3 Hours</option>
                    <option value="4">4 Hours</option>
                    <option value="5">5 Hours</option>
                    <option value="6">6 Hours</option>
                    <option value="7">7 Hours</option>
                    <option value="8">8 Hours</option>
                    <option value="9">9 Hours</option>
                    <option value="10">10 Hours</option>
                    <option value="11">11 Hours</option>
                    <option value="12">12 Hours</option>
                    <option value="13">13 Hours</option>
                    <option value="14">14 Hours</option>
                    <option value="15">15 Hours</option>
                    <option value="16">16 Hours</option>
                    <option value="17">17 Hours</option>
                    <option value="18">18 Hours</option>
                    <option value="19">19 Hours</option>
                    <option value="20">20 Hours</option>
                    <option value="21">21 Hours</option>
                    <option value="22">22 Hours</option>
                    <option value="23">23 Hours</option>
                </select>

                <select class="selector" id="minutes">
                    <option value="0">0 Minutes</option>
                    <option value="1">1 Minutes</option>
                    <option value="2">2 Minutes</option>
                    <option value="3">3 Minutes</option>
                    <option value="4">4 Minutes</option>
                    <option value="5">5 Minutes</option>
                    <option value="6">6 Minutes</option>
                    <option value="7">7 Minutes</option>
                    <option value="8">8 Minutes</option>
                    <option value="9">9 Minutes</option>
                    <option value="10">10 Minutes</option>
                    <option value="11">11 Minutes</option>
                    <option value="12">12 Minutes</option>
                    <option value="13">13 Minutes</option>
                    <option value="14">14 Minutes</option>
                    <option value="15">15 Minutes</option>
                    <option value="16">16 Minutes</option>
                    <option value="17">17 Minutes</option>
                    <option value="18">18 Minutes</option>
                    <option value="19">19 Minutes</option>
                    <option value="20">20 Minutes</option>
                    <option value="21">21 Minutes</option>
                    <option value="22">22 Minutes</option>
                    <option value="23">23 Minutes</option>
                    <option value="24">24 Minutes</option>
                    <option value="25">25 Minutes</option>
                    <option value="26">26 Minutes</option>
                    <option value="27">27 Minutes</option>
                    <option value="28">28 Minutes</option>
                    <option value="29">29 Minutes</option>
                    <option value="30">30 Minutes</option>
                    <option value="31">31 Minutes</option>
                    <option value="32">32 Minutes</option>
                    <option value="33">33 Minutes</option>
                    <option value="34">34 Minutes</option>
                    <option value="35">35 Minutes</option>
                    <option value="36">36 Minutes</option>
                    <option value="37">37 Minutes</option>
                    <option value="38">38 Minutes</option>
                    <option value="39">39 Minutes</option>
                    <option value="40">40 Minutes</option>
                    <option value="41">41 Minutes</option>
                    <option value="42">42 Minutes</option>
                    <option value="43">43 Minutes</option>
                    <option value="44">44 Minutes</option>
                    <option value="45">45 Minutes</option>                    
                    <option value="46">46 Minutes</option>
                    <option value="47">47 Minutes</option>
                    <option value="48">48 Minutes</option>
                    <option value="49">49 Minutes</option>
                    <option value="50">50 Minutes</option>
                    <option value="51">51 Minutes</option>
                    <option value="52">52 Minutes</option>
                    <option value="53">53 Minutes</option>
                    <option value="54">54 Minutes</option>
                    <option value="55">55 Minutes</option>
                    <option value="56">56 Minutes</option>
                    <option value="57">57 Minutes</option>
                    <option value="58">58 Minutes</option>
                    <option value="59">59 Minutes</option>
                </select>

                <select class="selector" id="seconds">
                    <option value="0">0 Seconds</option>
                    <option value="1">1 Seconds</option>
                    <option value="2">2 Seconds</option>
                    <option value="3">3 Seconds</option>
                    <option value="4">4 Seconds</option>
                    <option value="5">5 Seconds</option>
                    <option value="6">6 Seconds</option>
                    <option value="7">7 Seconds</option>
                    <option value="8">8 Seconds</option>
                    <option value="9">9 Seconds</option>
                    <option value="10">10 Seconds</option>
                    <option value="11">11 Seconds</option>
                    <option value="12">12 Seconds</option>
                    <option value="13">13 Seconds</option>
                    <option value="14">14 Seconds</option>
                    <option value="15">15 Seconds</option>
                    <option value="16">16 Seconds</option>
                    <option value="17">17 Seconds</option>
                    <option value="18">18 Seconds</option>
                    <option value="19">19 Seconds</option>
                    <option value="20">20 Seconds</option>
                    <option value="21">21 Seconds</option>
                    <option value="22">22 Seconds</option>
                    <option value="23">23 Seconds</option>
                    <option value="24">24 Seconds</option>
                    <option value="25">25 Seconds</option>
                    <option value="26">26 Seconds</option>
                    <option value="27">27 Seconds</option>
                    <option value="28">28 Seconds</option>
                    <option value="29">29 Seconds</option>
                    <option value="30">30 Seconds</option>
                    <option value="31">31 Seconds</option>
                    <option value="32">32 Seconds</option>
                    <option value="33">33 Seconds</option>
                    <option value="34">34 Seconds</option>
                    <option value="35">35 Seconds</option>
                    <option value="36">36 Seconds</option>
                    <option value="37">37 Seconds</option>
                    <option value="38">38 Seconds</option>
                    <option value="39">39 Seconds</option>
                    <option value="40">40 Seconds</option>
                    <option value="41">41 Seconds</option>
                    <option value="42">42 Seconds</option>
                    <option value="43">43 Seconds</option>
                    <option value="44">44 Seconds</option>
                    <option value="45">45 Seconds</option>                    
                    <option value="46">46 Seconds</option>
                    <option value="47">47 Seconds</option>
                    <option value="48">48 Seconds</option>
                    <option value="49">49 Seconds</option>
                    <option value="50">50 Seconds</option>
                    <option value="51">51 Seconds</option>
                    <option value="52">52 Seconds</option>
                    <option value="53">53 Seconds</option>
                    <option value="54">54 Seconds</option>
                    <option value="55">55 Seconds</option>
                    <option value="56">56 Seconds</option>
                    <option value="57">57 Seconds</option>
                    <option value="58">58 Seconds</option>
                    <option value="59">59 Seconds</option>
                </select>
            </div>
        </div>

        <div class="buttonSection">
            <div class="button1">
                <button class="roundButton" id="start">Start</button>
            </div>
            <div class="button2">
                <button class="roundButton" id="cancel">Cancel</button>
            </div>

        </div>


        <script>
            document.getElementById('start').addEventListener('click', startTimer);
            document.getElementById('cancel').addEventListener('click', cancelledButtonPressed);
            var startTime;
            var endTime;
            var origTimePeriod;
            var newTimePeriod;
            var timer;
            var cancelled = false;

            function startTimer(){

                cancelled = false;

                startTime = new Date();
                endTime = getEndTime();

                origTimePeriod = endTime.getTime() - startTime.getTime();
                newTimePeriod = origTimePeriod;

                 timer = setInterval(displayCountdown , 1000);
            }

            function displayCountdown(){

                var timeLeft = msToTime(newTimePeriod);

                document.getElementById('clock').innerHTML = ` <p>${timeLeft["hours"]}h ${timeLeft["minutes"]}m ${timeLeft["seconds"]}s</p>`; 

                var newHeight = Math.floor(newTimePeriod / origTimePeriod * 100) * 3;
                document.getElementById("progressBar").setAttribute("height" , newHeight);

                newTimePeriod -= 1000;

                if(newTimePeriod <0 || cancelled){
                    clearInterval(timer);
                    document.getElementById("clock").innerHTML = "<p>Complete!</p>";
                }

                
            }

            function cancelledButtonPressed(){
                cancelled = true;
            }

            function msToTime(milliseconds){
                var mHour = 1000 * 60 * 60;
                var mMinute = 1000 * 60;
                var mSeccond = 1000;

                var hours = Math.floor(milliseconds / mHour);
                var minutes = Math.floor((milliseconds % mHour) / mMinute);
                var seconds = Math.floor((milliseconds % mMinute) / mSeccond);

                var time = [];
                time["hours"] = hours;
                time["minutes"] = minutes;
                time["seconds"] = seconds;

                return time;
            }
            
            function getEndTime(){
                var dt = new Date();

                var hours = parseInt(document.getElementById('hours').value);
                var minutes = parseInt(document.getElementById('minutes').value);
                var seconds = parseInt(document.getElementById('seconds').value);

                
                dt.setHours(dt.getHours() + hours);
                dt.setMinutes(dt.getMinutes() + minutes);
                dt.setSeconds(dt.getSeconds() + seconds);
                return dt;
            }
        </script>
    </body>
</html>